<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Keycloak Giriş Örneği</title>
    <script>
      window.addEventListener("load", function () {
        var currentUrl = window.location.href;
        var codeStart = "code=";

        var _code = currentUrl.split(codeStart)[1];

        console.log("code=" + _code);

        if (_code) {
          var url =
            "https://sso.consumer.games/auth/realms/magic/protocol/openid-connect/token";
          var data = {
            code: _code,
            grant_type: "authorization_code",
            client_id: "account-console",
            redirect_uri:
              "https%3A%2F%2Fsso.consumer.games%2Fauth%2Frealms%2Fmagic%2Faccount%2F%23%2F",
          };

          fetch(url, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
            mode: "no-cors",
          })
            .then((response) => {
              if (!response.ok) {
                throw new Error("HTTP error, status = " + response.status);
              }
              return response.json();
            })
            .then((data) => {
              console.log(data); // Hata mesajını veya açıklamayı burada kontrol edebilirsiniz
            })
            .catch((error) => {
              console.error("Error:", error);
            });
        }
      });
    </script>
  </head>
  <body>
    <h1>Keycloak Giriş Örneği</h1>
  </body>
</html>
